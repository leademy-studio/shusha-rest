# Документация корзины и оформления заказа

## Обзор функционала

Система корзины и оформления заказа для Shusha Delivery включает:
- Добавление/удаление товаров
- Изменение количества
- Хранение в localStorage
- Модальные окна корзины и оформления заказа
- Форма с валидацией
- Визуальная обратная связь

## Файлы

### JavaScript
- **assets/js/cart.js** - полная логика корзины и оформления заказа
  - `ShoppingCart` - класс управления данными корзины
  - `CartUI` - UI модального окна корзины
  - `CheckoutUI` - UI формы оформления заказа

### CSS
- **assets/css/cart.css** - стили для корзины, кнопки, модальных окон и формы

### HTML
- Подключено в [catalog.html](catalog.html) и [index.html](index.html)

## API корзины

### ShoppingCart

#### Методы:
```javascript
cart.addItem(product)              // Добавить товар
cart.removeItem(productId)         // Удалить товар
cart.updateQuantity(id, quantity)  // Изменить количество
cart.incrementItem(productId)      // +1
cart.decrementItem(productId)      // -1
cart.getItems()                    // Все товары
cart.getTotalItems()               // Общее количество
cart.getTotalPrice()               // Общая стоимость
cart.clear()                       // Очистить
cart.hasItem(productId)            // Проверка наличия
cart.getItemQuantity(productId)    // Количество товара
```

#### Подписка на изменения:
```javascript
cart.subscribe((items) => {
    console.log('Корзина обновлена:', items);
});
```

## Интеграция с каталогом

Кнопки "В корзину" в каталоге автоматически:
1. Добавляют товар в корзину при клике
2. Показывают анимацию "Добавлено" (зеленая галочка)
3. Возвращаются к исходному виду через 1.5 сек

## Кнопка корзины

Плавающая кнопка в правом нижнем углу:
- Всегда видна на всех страницах
- Счетчик товаров (badge)
- Клик открывает модальное окно корзины

## Модальное окно корзины

Функции:
- Список товаров с изображениями
- Количество товаров (- / +)
- Удаление товаров
- Общая стоимость
- Кнопка "Оформить заказ"
- Состояние пустой корзины с призывом к действию

## Форма оформления заказа

### Поля:
1. **Контактные данные**
   - Имя (обязательно)
   - Телефон (обязательно, с маской)
   - Email (опционально)

2. **Адрес доставки**
   - Адрес (обязательно)
   - Комментарий (опционально)

3. **Способ оплаты**
   - Наличными курьеру
   - Картой курьеру
   - Оплата онлайн

### Валидация:
- HTML5 валидация (required, type="tel", type="email")
- Маска телефона: +7 (XXX) XXX-XX-XX
- Автоформатирование при вводе

### Отправка:
```javascript
// Формат данных заказа
{
    customer: {
        name: string,
        phone: string,
        email: string
    },
    delivery: {
        address: string,
        comment: string
    },
    payment: 'cash' | 'card' | 'online',
    items: Array<CartItem>,
    total: number,
    timestamp: string (ISO 8601)
}
```

## LocalStorage

Корзина автоматически сохраняется в `localStorage` под ключом `shushaCart`:
- Сохранение при любом изменении
- Автозагрузка при открытии страницы
- Переживает перезагрузку страницы

## Адаптивность

### Desktop:
- Модальное окно 480px справа
- Плавающая кнопка 64x64px

### Mobile:
- Модальное окно на всю ширину
- Плавающая кнопка 56x56px
- Оптимизированные размеры элементов

## Анимации

1. **Кнопка корзины**
   - Hover: поднимается вверх
   - Active: возвращается вниз

2. **Модальное окно**
   - Появление: slideInRight (справа)
   - Backdrop: fade + blur

3. **Добавление в корзину**
   - Зеленый фон
   - Галочка
   - Scale анимация

4. **Успешный заказ**
   - Зеленая галочка в круге
   - Сообщение об успехе

## Использование

### В каталоге:
Кнопки "В корзину" уже интегрированы, работают автоматически.

### На других страницах:
```html
<!-- Подключите скрипты -->
<script src="assets/js/cart.js"></script>

<!-- Используйте глобальный объект cart -->
<script>
cart.addItem({
    id: 'product-1',
    name: 'Товар',
    price: 500,
    imageUrl: 'image.jpg',
    category: 'Категория',
    weight: '300гр'
});
</script>
```

## Доработка для production

### TODO:
1. **API интеграция**
   - Создать endpoint `/api/orders`
   - Раскомментировать fetch в `handleSubmit()`
   - Добавить обработку ошибок

2. **Дополнительные функции**
   - История заказов
   - Избранное
   - Промокоды
   - Минимальная сумма заказа

3. **Уведомления**
   - Toast notifications вместо alert()
   - Telegram/Email уведомления

4. **Аналитика**
   - Отслеживание добавлений в корзину
   - Конверсия заказов
   - Популярные товары

## Тестирование

### Сценарии:
1. ✅ Добавление товара в корзину
2. ✅ Изменение количества
3. ✅ Удаление товара
4. ✅ Оформление заказа
5. ✅ Валидация формы
6. ✅ Сохранение в localStorage
7. ✅ Пустая корзина
8. ✅ Адаптивный дизайн

### Браузеры:
- Chrome/Edge ✅
- Firefox ✅
- Safari ✅
- Mobile browsers ✅

## Поддержка

Минимальные требования:
- ES6 (стрелочные функции, классы)
- localStorage API
- CSS Grid/Flexbox
- CSS animations

Поддержка: все современные браузеры (2020+)
